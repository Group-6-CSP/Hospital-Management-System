TestCaseID,Title,Priority,Preconditions,TestData,Steps,ExpectedResults,Cleanup,Automation
APPT-001,Book appointment - happy path,P1,"User 'Patient' exists and authenticated; Doctor D456 exists; Slot 2025-10-20 10:00 free","PatientId=P123, DoctorId=D456, Date=2025-10-20, Time=10:00","1. Login as Patient\n2. POST /appointments with payload\n3. GET /appointments/{id}","201 Created; Response contains AppointmentId; Status=Scheduled; Doctor/Patient/date/time correct; GET returns same","DELETE created appointment if any",API
APPT-002,Reschedule appointment - happy path,P1,"Existing Scheduled appointment for P123 with D456","AppointmentId=<existing>, NewDate=2025-10-21, NewTime=11:00","1. PUT /appointments/{id}/reschedule\n2. GET /appointments/{id}","200 OK; Status=Scheduled; date/time updated; history optionally tracked","Revert to original slot or DELETE",API
APPT-003,Cancel appointment - happy path,P1,"Existing Scheduled appointment for P123","AppointmentId=<existing>","1. PUT /appointments/{id}/cancel\n2. GET /appointments/{id}","200 OK; Status=Cancelled; subsequent booking in same slot allowed","None",API
APPT-004,Prevent double-booking (DB rule),P1,"Doctor D456 has Scheduled appt at 2025-10-20 10:00","DoctorId=D456, Date=2025-10-20, Time=10:00","1. Attempt POST /appointments for same doctor/date/time","409 Conflict or 400 with error; or DB rejects with unique constraint; only one active appt remains","None",Integration
APPT-005,List appointments by patient,P2,"Multiple appointments exist for P123 across dates","PatientId=P123, DateRange=2025-10-01..2025-10-31","1. GET /appointments?patientId=P123&from=2025-10-01&to=2025-10-31","200 OK; returns only P123 appointments in range; pagination honored","None",API
APPT-006,Search by doctor & status,P2,"Appointments exist for D456",DoctorId=D456, "1. GET /appointments?doctorId=D456&status=Scheduled","200 OK; only matching records; fields populated","None",API
APPT-007,Unauthorized booking attempt,P1,"Unauthenticated user","DoctorId=D456, Date=2025-10-22, Time=10:00","1. POST /appointments without token","401 Unauthorized","None",API
APPT-008,Forbidden booking as other patient,P1,"Authenticated as Patient P123","PatientId=P789, DoctorId=D456, Date=2025-10-22, Time=11:00","1. POST /appointments on behalf of P789","403 Forbidden","None",API
APPT-009,Invalid time format,P3,"Authenticated as Patient","Time=25:61","1. POST /appointments with invalid time","400 Bad Request; validation error on time","None",API
APPT-010,Past date booking blocked,P2,"Authenticated as Patient","Date=2024-01-01","1. POST /appointments in the past","400 Bad Request; cannot book in the past","None",API
APPT-011,Reschedule to occupied slot,P1,"Two different appointments exist at distinct slots","AppointmentId=A1 -> move to slot of A2","1. PUT /appointments/{A1}/reschedule to A2 slot","409/400 conflict; A2 remains scheduled; A1 unchanged","None",API
APPT-012,Cancel non-existent appointment,P3,"Authenticated as Patient",AppointmentId=DOES-NOT-EXIST,"1. PUT /appointments/{id}/cancel","404 Not Found","None",API
APPT-013,Doctor views assigned appointments,P2,"Authenticated as Doctor D456","DoctorId=D456","1. GET /appointments?doctorId=D456","200 OK; only D456 appointments","None",API
APPT-014,Patient views only own appointments,P1,"Authenticated as Patient P123","","1. GET /appointments (no filter) if endpoint supports current user\n2. Verify no other patient's data","200 OK; only P123 appointments","None",API
APPT-015,Pagination boundaries,P3,">50 appointments exist","pageSize=50, page=1..n","1. GET /appointments with pagination\n2. Verify counts and last page","200 OK; correct item counts; no duplicates","None",API
APPT-016,SQL injection attempt blocked,P1,"Authenticated as Patient","PatientId='P123; DROP TABLE Appointments;--'","1. POST /appointments with malicious strings","400/422 validation; DB intact","None",Security
APPT-017,Rate limit/concurrency,P2,"Authenticated as Patient; endpoint rate limit configured","10 parallel requests to same slot","1. Fire concurrent POSTs to same slot","Only one succeeds; others rejected; DB consistent","Remove created appointment",Integration
APPT-018,Timezone normalization,P3,"Authenticated as Patient; backend uses UTC","Date=boundary around DST","1. POST around DST transitions","Correct storage in UTC; server-side prevents past bookings due to TZ","Delete created appointments",Manual
APPT-019,Audit trail present,P3,"Authenticated as Admin; auditing enabled","AppointmentId=<existing>","1. Perform reschedule/cancel\n2. Query audit/DB history","Audit records exist with user and timestamp","None",Manual
APPT-020,Input validation - required fields,P1,"Authenticated as Patient","Missing DoctorId or Date or Time","1. POST with missing required fields","400/422 with clear field errors","None",API
APPT-021,Patient history shows required fields,P1,"Authenticated as Patient with past appointments","PatientId=P123","1. GET /appointments/history?patientId=P123\n2. Inspect first page items","200 OK; each entry has doctor name, date, time, status","None",API
APPT-022,History requires authentication,P1,"No auth token / expired token","","1. GET /appointments/history without auth","401 Unauthorized","None",API
APPT-023,History pagination >20,P2,">20 past appointments exist for P123","pageSize=20, page=1..n","1. GET history with pagination\n2. Verify page sizes and last page","200 OK; max 20 per page; consistent counts; no duplicates","None",API
APPT-024,History empty state message,P3,"Authenticated as Patient with no history","PatientId=P789 (no appts)","1. GET /appointments/history for P789","200 OK; returns empty list OR 404 with friendly message per spec","None",API
APPT-025,Reschedule sends notifications,P2,"Notifications channel configured (email/mock inbox); existing appointment","AppointmentId=<existing>, NewDate/TIme","1. Reschedule appointment\n2. Check patient and doctor notifications","Notifications received with new slot details","None",Manual
APPT-026,Booking performance SLO,P1,"Load tool configured; 100 concurrent users; diverse slots","100 concurrent POST /appointments (unique slots)","1. Run performance test for 60s","p95 latency < 2000ms; error rate < 1%","Cleanup any created appts",Performance
APPT-027,Unavailable slot shows error,P1,"Existing appointment occupies target slot","DoctorId=D456, occupied Date/Time","1. Attempt to book same slot via UI","User sees clear error message; no duplicate created","None",UI
APPT-028,Reschedule performance SLO,P2,"Load tool configured; 100 concurrent requests","100 concurrent PUT /appointments/{id}/reschedule (unique targets)","1. Run performance test for 60s","p95 latency < 2000ms; error rate < 1%","Revert/reschedule back",Performance
APPT-029,Reschedule updates DB immediately,P1,"Existing appointment","AppointmentId=<existing>, NewDate/Time","1. PUT reschedule\n2. Immediate GET by id","200 OK; GET reflects new date/time instantly","None",API
APPT-030,Admin stats daily/monthly,P2,"Admin authenticated; data exists across days/months","granularity=daily,monthly","1. GET /reports/stats?granularity=daily\n2. monthly","200 OK; returns series for requested period","None",API
APPT-031,Stats include per doctor/department,P2,"Admin authenticated; stats endpoint available","","1. GET stats with groupBy=doctor/department","200 OK; contains counts per doctor/department","None",API
APPT-032,Stats export CSV/PDF,P2,"Admin authenticated; export endpoints exist","format=csv,pdf","1. Request export endpoints\n2. Validate content-disposition / MIME","200 OK; correct file type; fields match on-sceen totals","None",Manual
APPT-033,Stats concurrency 500+,P2,"Performance tooling ready; autoscaling in place","500 virtual users GET stats","1. Run concurrency test","System handles without errors/timeouts; resource usage acceptable","None",Performance
APPT-034,Stats response <3s,P2,"Data volume representative","","1. Measure stats endpoint latency","p95 latency < 3000ms","None",Performance
APPT-035,Stats empty data message,P3,"Admin authenticated; date range with no data","","1. Request stats for empty window","200 OK with empty payload or 404 with friendly message per spec","None",API
APPT-036,History performance SLO,P2,"Load tool configured; dataset with history","100 concurrent GET /appointments/history?patientId=P123","1. Run performance test for 60s","p95 latency < 2000ms; error rate < 1%","None",Performance
